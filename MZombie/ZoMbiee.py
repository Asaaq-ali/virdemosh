import os
import asyncio
import sys
import redis, re
from dotenv import load_dotenv
from os import getenv
from pyrogram import *
from pyrogram.types import *
from pyrogram.errors import PeerIdInvalid
from pyrogram import Client, filters
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from bot import bot
from bot import DEVS
from bot import bot_id

OWNER_ID = int("6228635168")

r = redis.Redis(
  host='redis-13524.c84.us-east-1-2.ec2.cloud.redislabs.com',
  port=13524,
  password='J2tSRdAbiuSaFU3ROH2UqWWTahWR00b9')



Keyard = ReplyKeyboardMarkup(
  [
    [("ã€ŠØµÙ†Ø¹ Ø¨ÙˆØªã€‹"),("ã€ŠØ­Ø°Ù Ø¨ÙˆØªã€‹")],
    [("ã€ŠØµÙ†Ø¹ Ø¬Ù„Ø³Ù‡ã€‹")],
    [("ã€ŠØ§Ù„Ø³ÙˆØ±Ø³ã€‹"),("ã€ŠÙ…Ø·ÙˆØ± Ø§Ù„Ø³ÙˆØ±Ø³ã€‹")],
    [("Ø§Ù„ØºØ§Ø¡")]
  ],
  resize_keyboard=True
)


Keyboard = ReplyKeyboardMarkup(
  [
    [("Ø§Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯")],
    [("ã€ŠØµÙ†Ø¹ Ø¨ÙˆØªã€‹"),("ã€ŠØ­Ø°Ù Ø¨ÙˆØªã€‹")],
    [("ã€ŠØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠã€‹"),("ã€ŠØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠã€‹")],
    [("â€¢ Ù‚Ø³Ù… Ø§Ù„Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„ØªÙˆØ§ØµÙ„â€¢ ")],
    [("ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„"),("ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„")],
    [("ã€ŠØ§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù…ØµÙ†ÙˆØ¹Ù‡ã€‹"),("Ø§Ù„Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª")],
    [("â€¢ Ø§ÙˆØ§Ù…Ø± Ø§Ù„Ø§Ø°Ø§Ø¹Ù‡ Ùˆ Ø§Ù„Ø§Ø¯Ù…Ù†ÙŠÙ‡ â€¢")],
    [("Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªØ«Ø¨ÙŠØª"),("Ø§Ø°Ø§Ø¹Ø©"),("Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªÙˆØ¬ÙŠÙ‡")],
    [("Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª"),("Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¨Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª")],
    [("Ù‚Ø§Ø¦Ù…Ù‡ Ø§Ù„Ø£Ø¯Ù…Ù†ÙŠÙ‡"),("Ø±ÙØ¹ Ø§Ø¯Ù…Ù†"),("ØªÙ†Ø²ÙŠÙ„ Ø§Ø¯Ù…Ù†")],
    [("â€¢ Ø§ÙˆØ§Ù…Ø± Ø§Ù„Ù…Ù„ÙƒÙŠÙ‡ Ùˆ Ø§Ù„Ù†Ø³Ø®Ù‡ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠÙ‡ â€¢")],
    [("Ù†Ù‚Ù„ Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø¨ÙˆØª")],
    [("Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"),("Ø§Ù„Ø¬Ø±ÙˆØ¨Ø§Øª"),("Ø§Ù„Ø£Ø¯Ù…Ù†ÙŠØ©")],
    [("â€¢ Ø§ÙˆØ§Ù…Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø§Ø¬Ø¨Ø§Ø±ÙŠ â€¢")],
    [("ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"),("ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"),("Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ")],
    [("Ø¶Ø¹ Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"),("Ø­Ø°Ù Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ")],
    [("ã€ŠØµÙ†Ø¹ Ø¬Ù„Ø³Ù‡ã€‹")],
    [("ã€ŠØ§Ù„Ø³ÙˆØ±Ø³ã€‹")],
    [("Ø§Ù„ØºØ§Ø¡")]
  ],
  resize_keyboard=True
)

@bot.on_message(filters.command("start") & filters.private)
async def for_users (bot,m):
   if check(m.from_user.id):
     kep = ReplyKeyboardMarkup([["ã€ŠØµÙ†Ø¹ Ø¨ÙˆØªã€‹", "ã€ŠØ­Ø°Ù Ø¨ÙˆØªã€‹"], ["Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù…ØµÙ†ÙˆØ¹Ù‡"], ["ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ", "ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ"], ["ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„", "ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„"], ["Ø§Ù„Ø³ÙˆØ±Ø³"], ["Ø§Ù„ØºØ§Ø¡"]], resize_keyboard=True)
     return await m.reply_text(f"â•®â¦¿ Ø§Ù‡Ù€Ù„Ø§ Ø¨Úª Ø¹Ø²ÙŠÙ€Ø²ÙŠ Ø§Ù„Ù…Ø·Ù€ÙˆØ± Ø§Ù„Ø§Ø³Ø§Ø³Ù€ÙŠ  â½ {m.from_user.mention} â‚Ž\nâ”‚âŽ‹ Ø§Ù„ÙŠÙ€ÙƒÙ€ Ø§Ù„Ù…ØµÙ†Ù€Ø¹ Ø§Ù„Ø®Ù€Ø§Øµ Ø¯ÙŠÙ€Ù€Ù€Ù€Ù†Ø§ \nâ•¯â¦¿ Ù‚Ù†Ù€Ø§Ø© Ø§Ù„Ø³Ù€ÙˆØ±Ø³ : â² @Mlze1bot â³", reply_markup=Keyboard)
   kep = ReplyKeyboardMarkup([["ã€ŠØµÙ†Ø¹ Ø¨ÙˆØªã€‹", "ã€ŠØ­Ø°Ù Ø¨ÙˆØªã€‹"], ["ã€ŠØµÙ†Ø¹ Ø¬Ù„Ø³Ù‡ã€‹"], ["ã€ŠØ§Ù„Ø³ÙˆØ±Ø³ã€‹", "ã€ŠÙ…Ø·ÙˆØ± Ø§Ù„Ø³ÙˆØ±Ø³ã€‹"]], resize_keyboard=True)
   await m.reply_text(f"â•®â¦¿ Ø§Ù‡Ù€Ù„Ø§ Ø¨Úª Ø¹Ø²ÙŠÙ€Ø²ÙŠ â½ {m.from_user.mention} â‚Ž\nâ”‚âŽ‹ Ø§Ù„ÙŠÙ€ÙƒÙ€ Ø§Ù„Ù…ØµÙ†Ù€Ø¹ Ø§Ù„Ø®Ù€Ø§Øµ Ø¯ÙŠÙ€Ù€Ù€Ù€Ù†Ø§ \nâ•¯â¦¿ Ù‚Ù†Ù€Ø§Ø© Ø§Ù„Ø³Ù€ÙˆØ±Ø³ : â² @Mlze1bot â³", reply_markup=kep)
   if not check(m.from_user.id):
     await check_sub(bot, m)
   if not is_user(m.from_user.id):
     add_user(m.from_user.id)
     text = 'ðŸ™ Ø´Ø®Øµ Ø¬Ø¯ÙŠØ¯ Ø¯Ø®Ù„ Ø§Ù„Ù‰ Ø§Ù„Ø¨ÙˆØª !\n\n'
     text += f'ðŸŽ¯ Ø§Ù„Ø£Ø³Ù…: {m.from_user.first_name}\n'
     text += f'â™»ï¸ Ø§Ù„Ø§ÙŠØ¯ÙŠ: {m.from_user.id}\n\n'
     text += f'ðŸŒ Ø§ØµØ¨Ø­ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: {len(get_users())}'
     reply_markup=InlineKeyboardMarkup (
      [[
        InlineKeyboardButton (m.from_user.first_name, user_id=m.from_user.id)
      ]]
     )
     if len(get_admins()) > 0:
        list = get_admins()
        for admin in list:
          await bot.send_message(int(admin), text, reply_markup=reply_markup)
        await bot.send_message(int(r.get(f"bot_owner{bot_id}")), text, reply_markup=reply_markup)
     else:
        await bot.send_message(int(r.get(f"bot_owner{bot_id}")), text, reply_markup=reply_markup)
        
     
   
@bot.on_message(filters.command("LAVhshdhA") & filters.private, group=1)
async def keyboard_show(bot,m):
    if check(m.from_user.id):
       await m.reply(f"â€¢ Ø£Ù‡Ù„Ø§ Ø¨Ùƒ {m.from_user.mention} .\nâ€¢ Ø§Ù„ÙŠÙƒ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ…\nâ€¢ Ù„Ø§Ø¸Ù‡Ø§Ø± ÙƒÙŠØ¨ÙˆØ±Ø¯ Ø§Ù„Ù…Ø·ÙˆØ± /start", reply_markup=Keyboard, quote=True)

admins_commands = [
   'Ø§Ù„Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª', 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„',
   'ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„', 'Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªØ«Ø¨ÙŠØª', 'Ø§Ø°Ø§Ø¹Ø©',
   'Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªÙˆØ¬ÙŠÙ‡', 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ', 'ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ',
   'Ø¶Ø¹ Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ', 'Ø­Ø°Ù Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ', 'Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ','Ù‚Ø§Ø¦Ù…Ù‡ Ø§Ù„Ø£Ø¯Ù…Ù†ÙŠÙ‡',
   'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', 'Ø§Ù„Ø£Ø¯Ù…Ù†ÙŠØ©', 'Ø§Ù„Ø¬Ø±ÙˆØ¨Ø§Øª',
   'Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª','Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¨Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª', 'Ø§Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯'
   ]
   
owner_commands = [
   'Ù†Ù‚Ù„ Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø¨ÙˆØª', 'Ø±ÙØ¹ Ø§Ø¯Ù…Ù†', 'ØªÙ†Ø²ÙŠÙ„ Ø§Ø¯Ù…Ù†'
]

@bot.on_message(filters.text & filters.private, group=2)
async def keyboard_for_admins(bot, m):
  if m.text in admins_commands:
    if not check(m.from_user.id):
      return await m.reply('ðŸ¦¸ Ø§Ù„Ø§Ù…Ø± Ø¯Ù‡ Ù„Ù„Ù…Ø·ÙˆØ± Ø¨Ø³', quote=True)
    else:
    
      if m.text == 'Ø§Ù„Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª':
        text = f'**ðŸ‘¤ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: {len(get_users())}\n'
        text += f'ðŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª: {len(get_groups())}\n'
        text += f'ðŸŒ€ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†: {len(get_admins())}**'
        await m.reply(text, quote=True)
        
      if m.text == 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„':
        if r.get(f'enable_twasol{bot_id}'):
          return await m.reply("â€¢ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø³Ø¨Ù‚Ø§Ù‹", quote=True)
          
        await m.reply(f'**â€¢ Ø¨ÙˆØ§Ø³Ø·Ø© âŸ¨ {m.from_user.mention} âŸ©\nâ€¢ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¨Ù†Ø¬Ø§Ø­**', quote=True)
        r.set(f'enable_twasol{bot_id}', 1)
      
      if m.text == 'ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„':
        if not r.get(f'enable_twasol{bot_id}'):
          return await m.reply("â€¢ ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø³Ø¨Ù‚Ø§Ù‹", quote=True)
        await m.reply(f'**â€¢ Ø¨ÙˆØ§Ø³Ø·Ø© âŸ¨ {m.from_user.mention} âŸ©\nâ€¢ ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¨Ù†Ø¬Ø§Ø­**', quote=True)
        r.delete(f'enable_twasol{bot_id}')
      
      if m.text == 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†':
        await m.reply_document(get_users_backup(), quote=True)
      
      if m.text == 'Ø§Ù„Ø£Ø¯Ù…Ù†ÙŠØ©':
        await m.reply_document(get_admins_backup(), quote=True)
      
      if m.text == 'Ø§Ù„Ø¬Ø±ÙˆØ¨Ø§Øª':
        await m.reply_document(get_groups_backup(), quote=True)
      
      if m.text == 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ':
        if r.get(f"enable_force_subscribe{bot_id}"):
          return await m.reply('â€¢ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø§Ø¬Ø¨Ø§Ø±ÙŠ Ù…Ø³Ø¨Ù‚Ø§Ù‹',quote=True)
        await m.reply(f'**â€¢ Ø¨ÙˆØ§Ø³Ø·Ø© âŸ¨ {m.from_user.mention} âŸ©\nâ€¢ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ù†Ø¬Ø§Ø­**', quote=True) 
        r.set(f"enable_force_subscribe{bot_id}", 1)
      
      if m.text == 'ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ':
        if not r.get(f"enable_force_subscribe{bot_id}"):
          return await m.reply('â€¢ ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø§Ø¬Ø¨Ø§Ø±ÙŠ Ù…Ø³Ø¨Ù‚Ø§Ù‹',quote=True)
        await m.reply(f'**â€¢ Ø¨ÙˆØ§Ø³Ø·Ø© âŸ¨ {m.from_user.mention} âŸ©\nâ€¢ ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ù†Ø¬Ø§Ø­**', quote=True) 
        r.delete(f"enable_force_subscribe{bot_id}")
      
      if m.text == 'Ø¶Ø¹ Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ':
        await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø¹Ø§Ù… Ù…Ø«Ø§Ù„ @Mlze1bot", quote=True)
        r.set(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}",1)
        r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
      
      if m.text == 'Ø­Ø°Ù Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ':
        if not r.get(f'force_channel{bot_id}'):
          return await m.reply("â€¢ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ù†Ø§Ø© Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ø¹ÙŠÙ†Ø©", quote=True)
        await m.reply("â€¢ ØªÙ… Ø­Ø°Ù Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ù†Ø¬Ø§Ø­", quote=True)
        r.delete(f'force_channel{bot_id}')
      
      if m.text == 'Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ':
        if not r.get(f'force_channel{bot_id}'):
          await m.reply('â€¢ Ù„Ø§ØªÙˆØ¬Ø¯ Ù‚Ù†Ø§Ø© Ù…Ø¶Ø§ÙØ©', quote=True)
        else:
          channel = r.get(f'force_channel{bot_id}').decode('utf-8')
          await m.reply(f"https://t.me/{channel}", quote=True)
      
      if m.text == 'Ù‚Ø§Ø¦Ù…Ù‡ Ø§Ù„Ø£Ø¯Ù…Ù†ÙŠÙ‡':
        if len(get_admins()) == 0:
          await m.reply("â€¢ Ù„Ø§ÙŠÙˆØ¬Ø¯ Ø¢Ø¯Ù…Ù†ÙŠØ©", quote=True)
        else:
          text = 'â€¢ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¯Ù…Ù†ÙŠØ©\n'
          for admin in get_admins():
            try:
              get = await bot.get_chat(int(admin))
              text += f'â€¢ [{get.first_name}](tg://user?id={admin})\n'
            except:
              text += f'â€¢ [@Mlze1bot](tg://user?id={admin})\n'
          await m.reply(text, quote=True)
          
      if m.text == 'Ø§Ø°Ø§Ø¹Ø©':
        await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø¢Ù† ( ØµÙˆØ±Ø©ØŒ Ù…Ù„ØµÙ‚ØŒ Ù†ØµØŒ Ù…ØªØ­Ø±ÙƒØ©ØŒ Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ØŒ Ù…Ù„Ù )",quote=True)
        r.set(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}",1)
        r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
      
      if m.text == 'Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªØ«Ø¨ÙŠØª':
        await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø¢Ù† ( ØµÙˆØ±Ø©ØŒ Ù…Ù„ØµÙ‚ØŒ Ù†ØµØŒ Ù…ØªØ­Ø±ÙƒØ©ØŒ Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ØŒ Ù…Ù„Ù )",quote=True)
        r.set(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}",1)
        r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
        
      if m.text == 'Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªÙˆØ¬ÙŠÙ‡':
        await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø¢Ù† ( ØµÙˆØ±Ø©ØŒ Ù…Ù„ØµÙ‚ØŒ Ù†ØµØŒ Ù…ØªØ­Ø±ÙƒØ©ØŒ Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ØŒ Ù…Ù„Ù )",quote=True)
        r.set(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}",1)
        r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
      
      if m.text == 'Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª':
        await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø¢Ù† ( ØµÙˆØ±Ø©ØŒ Ù…Ù„ØµÙ‚ØŒ Ù†ØµØŒ Ù…ØªØ­Ø±ÙƒØ©ØŒ Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ØŒ Ù…Ù„Ù )",quote=True)
        r.set(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}",1)
        r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
      
      if m.text == 'Ø§Ø°Ø§Ø¹Ø© Ø¨Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¨Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª':
        await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ø¢Ù† ( ØµÙˆØ±Ø©ØŒ Ù…Ù„ØµÙ‚ØŒ Ù†ØµØŒ Ù…ØªØ­Ø±ÙƒØ©ØŒ Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ØŒ Ù…Ù„Ù )",quote=True)
        r.set(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}",1)
        r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
        r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
      
      if m.text == 'Ø§Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯':
        await m.reply("â€¢ ØªÙ… Ø§Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ø§Ø¸Ù‡Ø§Ø±Ù‡Ø§ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø§Ø±Ø³Ù„ /start",
        quote=True, reply_markup=ReplyKeyboardRemove (selective=True))


@bot.on_message(filters.text & filters.private, group=3)
async def for_owner(bot,m):
  text = m.text
  if text in owner_commands:
   if not m.from_user.id == int(r.get(f"bot_owner{bot_id}")):
      return await m.reply("â€¢ Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙŠØ®Øµ Ø§Ù„Ù…Ø·ÙˆØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙÙ‚Ø·", quote=True)
   
   if text == 'Ù†Ù‚Ù„ Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø¨ÙˆØª':
     await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø§Ù„Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ø¢Ù†", quote=True)
     r.set(f"{m.from_user.id}transfer{m.chat.id}{bot_id}",1)
     r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
   if text == 'Ø±ÙØ¹ Ø§Ø¯Ù…Ù†':
     await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¢Ø¯Ù…Ù† Ø§Ù„Ø¢Ù†", quote=True)
     r.set(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}",1)
     r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
   
   if text == 'ØªÙ†Ø²ÙŠÙ„ Ø§Ø¯Ù…Ù†':
     await m.reply("â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¢Ø¯Ù…Ù† Ø§Ù„Ø¢Ù†", quote=True)
     r.set(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}", 1)
     r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
     r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")

@bot.on_message(filters.text & filters.private, group=4)
async def response_for_commands(bot,m):
   text = m.text
   
   if text in admins_commands:
     return

   if text in owner_commands:
     return 
     
   if check(m.from_user.id):
     if text == 'Ø§Ù„ØºØ§Ø¡':
       await m.reply("â€¢ ØªÙ… Ø§Ù„ØºØ§Ø¡ ÙƒÙ„ Ø´ÙŠØ¡", quote=True)
       r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
       r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
       
     
     if r.get(f"{m.from_user.id}transfer{m.chat.id}{bot_id}"):
       try:
         get = await bot.get_chat(int(text))
       except:
         return await m.reply("â€¢ Ø§Ù„Ø¢ÙŠØ¯ÙŠ Ø®Ø·Ø£ Ø£Ø±Ø³Ù„ Ø¢ÙŠØ¯ÙŠ Ø¢Ø®Ø± Ø§Ùˆ ØªØ£ÙƒØ¯ Ø§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ùˆ Ø­Ø§Ø¸Ø± Ø§Ù„Ø¨ÙˆØª", quote=True)
       r.delete(f"{m.from_user.id}transfer{m.chat.id}{bot_id}")
       txt = 'â€¢ ØªÙ… Ù†Ù‚Ù„ Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰ :\n\n'
       txt += f'â€¢ Ø§Ù„Ø£Ø³Ù… : {get.first_name}\n'
       txt += f'â€¢ Ø§Ù„Ø¢ÙŠØ¯ÙŠ : {get.id}\n'
       if get.username:
         txt += f'â€¢ Ø§Ù„ÙŠÙˆØ²Ø± : @{get.username}\n'
       if get.bio:
         txt += f'â€¢ Ø§Ù„Ø¨Ø§ÙŠÙˆ : {get.bio}\n'
       r.set(f"bot_owner{bot_id}", get.id)
       await m.reply(txt, quote=True)
       return
     
     if r.get(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}"):
       try:
         get = await bot.get_chat(int(text))
       except:
         return await m.reply("â€¢ Ø§Ù„Ø¢ÙŠØ¯ÙŠ Ø®Ø·Ø£ Ø£Ø±Ø³Ù„ Ø¢ÙŠØ¯ÙŠ Ø¢Ø®Ø± Ø§Ùˆ ØªØ£ÙƒØ¯ Ø§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ùˆ Ø­Ø§Ø¸Ø± Ø§Ù„Ø¨ÙˆØª", quote=True)
         
       if is_admin(int(text)):
         r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
         return await m.reply(f"â€¢ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… [{get.first_name}]({get.id}) Ø§Ø¯Ù…Ù† Ù…Ù† Ù‚Ø¨Ù„")
       r.delete(f"{m.from_user.id}addadmin{m.chat.id}{bot_id}")
       txt = 'â€¢ ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­ :\n\n'
       txt += f'â€¢ Ø§Ù„Ø£Ø³Ù… : {get.first_name}\n'
       txt += f'â€¢ Ø§Ù„Ø¢ÙŠØ¯ÙŠ : {get.id}\n'
       if get.username:
         txt += f'â€¢ Ø§Ù„ÙŠÙˆØ²Ø± : @{get.username}\n'
       if get.bio:
         txt += f'â€¢ Ø§Ù„Ø¨Ø§ÙŠÙˆ : {get.bio}\n'
       add_admin(int(text))
       await m.reply(txt, quote=True)
       return 
     
     if r.get(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}"):
      try: 
       if not is_admin(int(text)):
         r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
         return await m.reply("â€¢ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ùˆ Ø§Ø¯Ù…Ù† Ù…Ù† Ù‚Ø¨Ù„")
       r.delete(f"{m.from_user.id}deladmin{m.chat.id}{bot_id}")
       del_admin(int(text))
       await m.reply("â€¢ ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­", quote=True)
       return 
      except:
       return await m.reply("â€¢ Ø§Ù„Ø¢ÙŠØ¯ÙŠ Ø®Ø·Ø£")
     
     if r.get(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}"):
       channel = text.replace("@","")
       r.set(f"force_channel{bot_id}", channel)
       r.delete(f"{m.from_user.id}addchannel{m.chat.id}{bot_id}")
       await m.reply("â€¢ ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­ ", quote=True)
       
     
     
@bot.on_message(filters.private, group=8)
async def forbroacasts(bot,m):
   if m.text:
      if m.text in admins_commands:  return
      if m.text in owner_commands:  return 
   if m.from_user:
     if r.get(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}"):
       r.delete(f"{m.from_user.id}broadcast{m.chat.id}{bot_id}")
       rep = await m.reply("â€¢ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© ..", quote=True)
       for user in get_users():
          try:
            await m.copy(int(user))
          except PeerIdInvalid:
            del_user(int(user))
            pass
          except Exception:
            pass
       await rep.edit("â€¢ ØªÙ…Øª Ø§Ù„Ø§Ø°Ø§Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­")
     
     if r.get(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}"):
       r.delete(f"{m.from_user.id}broadcastpin{m.chat.id}{bot_id}")
       rep = await m.reply("â€¢ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© ..", quote=True)
       for user in get_users():
          try:
            a = await m.copy(int(user))
            await a.pin(disable_notification=False,both_sides=True)
          except PeerIdInvalid:
            del_user(int(user))
            pass
          except Exception as e:
            print(e)
            pass
       await rep.edit("â€¢ ØªÙ…Øª Ø§Ù„Ø§Ø°Ø§Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­")
     
     if r.get(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}"):
       r.delete(f"{m.from_user.id}broadcastfor{m.chat.id}{bot_id}")
       rep = await m.reply("â€¢ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© ..", quote=True)
       for user in get_users():
          try:
            await m.forward(int(user))
          except PeerIdInvalid:
            del_user(int(user))
            pass
          except Exception:
            pass
       await rep.edit("â€¢ ØªÙ…Øª Ø§Ù„Ø§Ø°Ø§Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­")
     
     if r.get(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}"):
       r.delete(f"{m.from_user.id}gbroad{m.chat.id}{bot_id}")
       rep = await m.reply("â€¢ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© ..", quote=True)
       for group in get_groups():
          try:
            await m.copy(int(group))
          except Exception:
            pass
       await rep.edit("â€¢ ØªÙ…Øª Ø§Ù„Ø§Ø°Ø§Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­")
       
     
     if r.get(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}"):
       r.delete(f"{m.from_user.id}gbroadpin{m.chat.id}{bot_id}")
       rep = await m.reply("â€¢ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© ..", quote=True)
       for group in get_groups():
          try:
            a = await m.copy(int(group))
            await a.pin(disable_notification=False)
          except Exception:
            pass
       await rep.edit("â€¢ ØªÙ…Øª Ø§Ù„Ø§Ø°Ø§Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­")

@bot.on_message(filters.private, group=9)
async def twasol__(bot,m):
   if not check(m.from_user.id):
     if r.get(f'enable_twasol{bot_id}'):
       await m.forward(int(r.get(f"bot_owner{bot_id}")))
   
   if m.from_user.id == int(r.get(f"bot_owner{bot_id}")):
      if m.reply_to_message:
        if m.reply_to_message.forward_from:
          await m.reply(f"â€¢ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø¥Ù„Ù‰ {m.reply_to_message.forward_from.first_name} Ø¨Ù†Ø¬Ø§Ø­", quote=True)
          try:
            await m.copy(m.reply_to_message.forward_from.id)
          except:
            pass
      

@bot.on_message(filters.text & filters.group , group=10)
async def for_admins_in_group(bot,m):
   if not m.reply_to_message:
      return
   if not m.reply_to_message.from_user:
      return
      
   if m.from_user.id == int(r.get(f"bot_owner{bot_id}")):
     text = m.text
     user_id = m.reply_to_message.from_user.id
     if text == 'Ø±ÙØ¹ Ø§Ø¯Ù…Ù†':
       if is_admin(user_id):
          return await m.reply("â€¢ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¢Ø¯Ù…Ù† Ù…Ù† Ù‚Ø¨Ù„")
       else:
          add_admin(user_id)
          await m.reply("â€¢ ØªÙ… Ø±ÙØ¹Ù‡ Ø§Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­")
     
     if text == 'ØªÙ†Ø²ÙŠÙ„ Ø§Ø¯Ù…Ù†':
      if not is_admin(user_id):
          return await m.reply("â€¢ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ùˆ Ø¢Ø¯Ù…Ù† Ù…Ù† Ù‚Ø¨Ù„")
      else:
          del_admin(user_id)
          await m.reply("â€¢ ØªÙ… ØªÙ†Ø²ÙŠÙ„Ù‡ Ø§Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­")

def add_user(user_id: int):
	if is_user(user_id):
		return
	r.sadd(f"botusers{bot_id}", user_id)
	
def is_user(user_id: int):
  try:
    a= get_users()
    if user_id in a:
      return True
    return False
  except:
    return False

def del_user(user_id: int):
	if not is_user(user_id):
		return False
	r.srem(f"botusers{bot_id}", user_id)
	return True

def get_users():
   try:
     list = []
     for a in r.smembers(f"botusers{bot_id}"):
        list.append(int(a.decode('utf-8')))
     return list
   except:
     return []

def get_users_backup() -> str:
	text = ''
	for user in r.smembers(f"botusers{bot_id}"):
		text += user.decode('utf-8')+'\n'
	with open('users.txt', 'w+') as f:
		f.write(text)
	return 'users.txt'
	
def add_admin(user_id: int):
    if is_admin(user_id):  return 
    r.sadd(f"botadmins{bot_id}", user_id)

def is_admin(user_id: int):
  try:
    a = get_admins()
    if user_id in a:
      return True
    return False
  except:
    return False

def del_admin(user_id: int):
	if not is_admin(user_id):
		return False
	r.srem(f"botadmins{bot_id}", user_id)
	
def get_admins():
   try:
     list = []
     for a in r.smembers(f"botadmins{bot_id}"):
        list.append(int(a.decode('utf-8')))
     return list
   except:
     return []

def get_admins_backup() -> str:
	text = ''
	for admin in r.smembers(f"botadmins{bot_id}"):
		text += admin.decode('utf-8')+'\n'
	with open('admins.txt', 'w+') as f:
		f.write(text)
	return 'admins.txt'
	

def check(id):
    if is_admin(id):
      return True
    if id == int(r.get(f"bot_owner{bot_id}")):
      return True
    else:
      return False

async def check_sub(c,m):
    if not r.get(f"enable_force_subscribe{bot_id}"):
      return
    else:
      if not r.get(f"force_channel{bot_id}"):
        return 
      else:
        channel = r.get(f"force_channel{bot_id}").decode('utf-8')
        text = f'âœ–ï¸ Ø¹Ø°Ø±Ø§Ù‹ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª Ø£ÙˆÙ„Ø§Ù‹ Ù„ØªØªÙ…ÙƒÙ† Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ !\n\nhttps://t.me/{channel}\n- /start'
        try:
           get = await c.get_chat_member(r.get(f"force_channel{bot_id}").decode('utf-8'), m.from_user.id)
           if get.status in [enums.ChatMemberStatus.LEFT, enums.ChatMemberStatus.BANNED]:
             return await m.reply(text, quote=True, disable_web_page_preview=True)
        except:
           return await m.reply(text, quote=True, disable_web_page_preview=True)

def add_group(chat_id: int):
    if is_group(chat_id):  return 
    r.sadd(f"botgroups{bot_id}", chat_id)

def is_group(chat_id: int):
  try:
    a = get_groups()
    if chat_id in a:
      return True 
    return False 
  except:
    return False

def del_group(chat_id: int):
	if not is_group(chat_id):
		return False
	r.srem(f"botgroups{bot_id}", chat_id)

def get_groups():
   try:
     list = []
     for a in r.smembers(f"botgroups{bot_id}"):
        list.append(int(a.decode('utf-8')))
     return list
   except:
     return []

def get_groups_backup() -> str:
	text = ''
	for group in r.smembers(f"botgroups{bot_id}"):
		text += group.decode('utf-8')+'\n'
	with open('groups.txt', 'w+') as f:
		f.write(text)
	return 'groups.txt'

if not r.get(f"bot_owner{bot_id}"):
   owner = int(input("Enter owner id : "))
   r.set(f"bot_owner{bot_id}", owner)
